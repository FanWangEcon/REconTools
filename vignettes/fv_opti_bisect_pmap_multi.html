<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Solve Roots for N (Rows) Strictly Monotonic Functions</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>
<style type="text/css">
a.anchor-section {margin-left: 10px; visibility: hidden; color: inherit;}
a.anchor-section::before {content: '#';}
.hasAnchor:hover a.anchor-section {visibility: visible;}
</style>
<script>// Anchor sections v1.0 written by Atsushi Yasumoto on Oct 3rd, 2020.
document.addEventListener('DOMContentLoaded', function() {
  // Do nothing if AnchorJS is used
  if (typeof window.anchors === 'object' && anchors.hasOwnProperty('hasAnchorJSLink')) {
    return;
  }

  const h = document.querySelectorAll('h1, h2, h3, h4, h5, h6');

  // Do nothing if sections are already anchored
  if (Array.from(h).some(x => x.classList.contains('hasAnchor'))) {
    return null;
  }

  // Use section id when pandoc runs with --section-divs
  const section_id = function(x) {
    return ((x.classList.contains('section') || (x.tagName === 'SECTION'))
            ? x.id : '');
  };

  // Add anchors
  h.forEach(function(x) {
    const id = x.id || section_id(x.parentElement);
    if (id === '') {
      return null;
    }
    let anchor = document.createElement('a');
    anchor.href = '#' + id;
    anchor.classList = ['anchor-section'];
    x.classList.add('hasAnchor');
    x.appendChild(anchor);
  });
});
</script>
<script>$(document).ready(function(){
    if (typeof $('[data-toggle="tooltip"]').tooltip === 'function') {
        $('[data-toggle="tooltip"]').tooltip();
    }
    if ($('[data-toggle="popover"]').popover === 'function') {
        $('[data-toggle="popover"]').popover();
    }
});
</script>
<style type="text/css">
.lightable-minimal {
border-collapse: separate;
border-spacing: 16px 1px;
width: 100%;
margin-bottom: 10px;
}
.lightable-minimal td {
margin-left: 5px;
margin-right: 5px;
}
.lightable-minimal th {
margin-left: 5px;
margin-right: 5px;
}
.lightable-minimal thead tr:last-child th {
border-bottom: 2px solid #00000050;
empty-cells: hide;
}
.lightable-minimal tbody tr:first-child td {
padding-top: 0.5em;
}
.lightable-minimal.lightable-hover tbody tr:hover {
background-color: #f5f5f5;
}
.lightable-minimal.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-classic {
border-top: 0.16em solid #111111;
width: 100%;
margin-bottom: 10px;
margin: 10px 5px;
}
.lightable-classic caption {
color: #222222;
}
.lightable-classic td {
padding-left: 5px;
padding-right: 5px;
color: #222222;
}
.lightable-classic th {
padding-left: 5px;
padding-right: 5px;
font-weight: normal;
color: #222222;
}
.lightable-classic thead tr:last-child th {
border-bottom: 0.10em solid #111111;
}
.lightable-classic tbody tr:last-child td {
border-bottom: 0.14em solid #111111;
}
.lightable-classic.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-classic.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-classic-2 {
border-top: 3px double #111111;
width: 100%;
margin-bottom: 10px;
}
.lightable-classic-2 caption {
color: #222222;
}
.lightable-classic-2 td {
padding-left: 5px;
padding-right: 5px;
color: #222222;
}
.lightable-classic-2 th {
padding-left: 5px;
padding-right: 5px;
font-weight: normal;
color: #222222;
}
.lightable-classic-2 tbody tr:last-child td {
border-bottom: 3px double #111111;
}
.lightable-classic-2 thead tr:last-child th {
border-bottom: 1px solid #111111;
}
.lightable-classic-2.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-classic-2.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-material {
min-width: 100%;
white-space: nowrap;
table-layout: fixed;
font-family: Roboto, sans-serif;
border: 1px solid #EEE;
border-collapse: collapse;
margin-bottom: 10px;
}
.lightable-material th {
height: 56px;
padding-left: 16px;
padding-right: 16px;
}
.lightable-material td {
height: 52px;
padding-left: 16px;
padding-right: 16px;
border-top: 1px solid #eeeeee;
}
.lightable-material.lightable-hover tbody tr:hover {
background-color: #f5f5f5;
}
.lightable-material.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-material.lightable-striped tbody td {
border: 0;
}
.lightable-material.lightable-striped thead tr:last-child th {
border-bottom: 1px solid #ddd;
}
.lightable-material-dark {
min-width: 100%;
white-space: nowrap;
table-layout: fixed;
font-family: Roboto, sans-serif;
border: 1px solid #FFFFFF12;
border-collapse: collapse;
margin-bottom: 10px;
background-color: #363640;
}
.lightable-material-dark th {
height: 56px;
padding-left: 16px;
padding-right: 16px;
color: #FFFFFF60;
}
.lightable-material-dark td {
height: 52px;
padding-left: 16px;
padding-right: 16px;
color: #FFFFFF;
border-top: 1px solid #FFFFFF12;
}
.lightable-material-dark.lightable-hover tbody tr:hover {
background-color: #FFFFFF12;
}
.lightable-material-dark.lightable-striped tbody tr:nth-child(even) {
background-color: #FFFFFF12;
}
.lightable-material-dark.lightable-striped tbody td {
border: 0;
}
.lightable-material-dark.lightable-striped thead tr:last-child th {
border-bottom: 1px solid #FFFFFF12;
}
.lightable-paper {
width: 100%;
margin-bottom: 10px;
color: #444;
}
.lightable-paper thead tr:last-child th {
color: #666;
vertical-align: bottom;
border-bottom: 1px solid #00000020;
line-height: 1.15em;
padding: 10px 5px;
}
.lightable-paper td {
vertical-align: middle;
border-bottom: 1px solid #00000010;
line-height: 1.15em;
padding: 7px 5px;
}
.lightable-paper.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-paper.lightable-striped tbody tr:nth-child(even) {
background-color: #00000008;
}
.lightable-paper.lightable-striped tbody td {
border: 0;
}
</style>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Solve Roots for N (Rows) Strictly Monotonic Functions</h1>



<p>Solve for roots for the same function across N sets of parameter values. This file works out how the <a href="https://fanwangecon.github.io/REconTools/reference/ff_opti_bisect_pmap_multi.html">ff_opti_bisect_pmap_multi</a> function works from <a href="https://fanwangecon.github.io/">Fan</a>’s <em><a href="https://fanwangecon.github.io/REconTools/">REconTools</a></em> Package. Also see a closely related file from <a href="https://fanwangecon.github.io/R4Econ/">R4Econ</a>, <a href="https://fanwangecon.github.io/R4Econ/optimization/root_bisect/fs_func_graph_eval.html">DPLYR Bisection</a>, which works out in greater detail the bisection algorithm.</p>
<p>We want solve for function <span class="math inline">\(0=f(z_{ij}, x_i, y_i, \textbf{X}, \textbf{Y}, c, d)\)</span>. There are <span class="math inline">\(i\)</span> functions that have <span class="math inline">\(i\)</span> specific <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>. For each <span class="math inline">\(i\)</span> function, we evaluate along a grid of feasible values for <span class="math inline">\(z\)</span>, over <span class="math inline">\(j\in J\)</span> grid points, potentially looking for the <span class="math inline">\(j\)</span> that is closest to the root. <span class="math inline">\(j\)</span> could be interpreted as iterations. <span class="math inline">\(\textbf{X}\)</span> and <span class="math inline">\(\textbf{Y}\)</span> are arrays common across the <span class="math inline">\(i\)</span> equations, and <span class="math inline">\(c\)</span> and <span class="math inline">\(d\)</span> are constants.</p>
<p>As we iterate over <span class="math inline">\(j\)</span>, find the <span class="math inline">\(z_{ij}\)</span> that is <span class="math inline">\(i\)</span> specific that allows for <span class="math inline">\(f_{i}(z_{ij})=0\)</span>.</p>
<p>In the code below, we develop the bisection code line by line, then we write it as a function using pmap. At the end, we test the concurrent bisection code over tibble dataframe with a set of straight lines (negative intercepts and positive slopes), and the log-linear solution for optimal allocation function from <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/PrjOptiAlloc/">PrjOptiAlloc</a> Project.</p>
<div id="bisection-algorithm" class="section level2">
<h2>Bisection Algorithm</h2>
<p>This is how I implement the bisection algorithm, when we know the bounding minimum and maximum to be below and above zero already.</p>
<ol style="list-style-type: decimal">
<li>Evaluate <span class="math inline">\(f^0_a = f(a^0)\)</span> and <span class="math inline">\(f^0_b = f(b^0)\)</span>, min and max points.</li>
<li>Evaluate at <span class="math inline">\(f^0_p = f(p^0)\)</span>, where <span class="math inline">\(p_0 = \frac{a^0+b^0}{2}\)</span>.</li>
<li>if <span class="math inline">\(f^i_a \cdot f^i_p &lt; 0\)</span>, then <span class="math inline">\(b_{i+1} = p_i\)</span>, else, <span class="math inline">\(a_{i+1} = p_i\)</span> and <span class="math inline">\(f^{i+1}_a = p_i\)</span>.</li>
<li>iteratre until convergence.</li>
</ol>
<p>And for the function we want to bisect over, as stated earlier, it has three types of variables:</p>
<ol style="list-style-type: decimal">
<li>variables in file for grouping, each group is an individual for whom we want to calculate optimal choice for using bisection.</li>
<li>variables that change each row and each iteration, the root we are looking for.</li>
<li>scalar and array values that are applied to every row and persist across iterations.</li>
</ol>
</div>
<div id="set-up-for-implementation" class="section level1">
<h1>Set up for Implementation</h1>
<p>Invoking the algorithm uses several key tidyverse functions:</p>
<ol style="list-style-type: decimal">
<li><em>pmap</em> from <a href="https://purrr.tidyverse.org/index.html">purrr</a> to evaluate function row by row.</li>
<li><em>case_when</em> from <a href="https://dplyr.tidyverse.org/reference/case_when.html">dplyr</a> to set new lower and upper bound.</li>
<li><em>pivot_wider</em> and <em>pivot_longer</em> from <a href="https://tidyr.tidyverse.org/index.html">tidyr</a> to reshape resulting file if record all iteration results.</li>
</ol>
<div id="load-packages" class="section level2">
<h2>Load Packages</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rm(list = ls(all.names = TRUE))</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(REconTools)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span></code></pre></div>
</div>
<div id="set-up-input-arrays" class="section level2">
<h2>Set up Input Arrays</h2>
<p>There is a function that takes <span class="math inline">\(M=Q+P\)</span> inputs, we want to evaluate this function <span class="math inline">\(N\)</span> times. Each time, there are <span class="math inline">\(M\)</span> inputs, where all but <span class="math inline">\(Q\)</span> of the <span class="math inline">\(M\)</span> inputs, meaning <span class="math inline">\(P\)</span> of the <span class="math inline">\(M\)</span> inputs, are the same. In particular, <span class="math inline">\(P=Q*N\)</span>.</p>
<p><span class="math display">\[M = Q+P = Q + Q*N\]</span></p>
<p>Now we need to expand this by the number of choice grid. Each row, representing one equation, is expanded by the number of choice grids. We are graphically searching, or rather brute force searching, which means if we have 100 individuals, we want to plot out the nonlinear equation for each of these lines, and show graphically where each line crosses zero. We achieve this, by evaluating the equation for each of the 100 individuals along a grid of feasible choices.</p>
<p>In this problem here, the feasible choices are shared across individuals.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>fl_rho <span class="ot">=</span> <span class="fl">0.20</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>svr_id_var <span class="ot">=</span> <span class="st">&#39;INDI_ID&#39;</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># it_child_count = N, the number of children</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>it_N_child_cnt <span class="ot">=</span> <span class="dv">9</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># it_heter_param = Q, number of parameters that are heterogeneous across children</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>it_Q_hetpa_cnt <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># P fixed parameters, nN is N dimensional, nP is P dimensional</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>ar_nN_A <span class="ot">=</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">length.out =</span> it_N_child_cnt)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>ar_nN_alpha <span class="ot">=</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">length.out =</span> it_N_child_cnt)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>ar_nP_A_alpha <span class="ot">=</span> <span class="fu">c</span>(ar_nN_A, ar_nN_alpha)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co"># N by Q varying parameters</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>mt_nN_by_nQ_A_alpha <span class="ot">=</span> <span class="fu">cbind</span>(ar_nN_A, ar_nN_alpha)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Choice Grid for nutritional feasible choices for each</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>fl_N_agg <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>fl_N_min <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Mesh Expand</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>tb_states_choices <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mt_nN_by_nQ_A_alpha) <span class="sc">%&gt;%</span> <span class="fu">rowid_to_column</span>(<span class="at">var=</span>svr_id_var)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>ar_st_col_names <span class="ot">=</span> <span class="fu">c</span>(svr_id_var,<span class="st">&#39;fl_A&#39;</span>, <span class="st">&#39;fl_alpha&#39;</span>)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>tb_states_choices <span class="ot">&lt;-</span> tb_states_choices <span class="sc">%&gt;%</span> <span class="fu">rename_all</span>(<span class="sc">~</span><span class="fu">c</span>(ar_st_col_names))</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="co"># display</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tb_states_choices)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     INDI_ID       fl_A       fl_alpha  </span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Min.   :1   Min.   :-2   Min.   :0.1  </span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1st Qu.:3   1st Qu.:-1   1st Qu.:0.3  </span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Median :5   Median : 0   Median :0.5  </span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Mean   :5   Mean   : 0   Mean   :0.5  </span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.:7   3rd Qu.: 1   3rd Qu.:0.7  </span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Max.   :9   Max.   : 2   Max.   :0.9</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(tb_states_choices) <span class="sc">%&gt;%</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>, <span class="st">&quot;responsive&quot;</span>))</span></code></pre></div>
<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
INDI_ID
</th>
<th style="text-align:right;">
fl_A
</th>
<th style="text-align:right;">
fl_alpha
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-2.0
</td>
<td style="text-align:right;">
0.1
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
-1.5
</td>
<td style="text-align:right;">
0.2
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
-1.0
</td>
<td style="text-align:right;">
0.3
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
-0.5
</td>
<td style="text-align:right;">
0.4
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0.6
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
0.7
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
1.5
</td>
<td style="text-align:right;">
0.8
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:right;">
0.9
</td>
</tr>
</tbody>
</table>
</div>
<div id="create-nonlinear-root-function" class="section level2">
<h2>Create Nonlinear Root Function</h2>
<p>These is a test functions over which we will searh for roots.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define Implicit Function</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>ffi_nonlin_dplyrdo <span class="ot">&lt;-</span> <span class="cf">function</span>(fl_A, fl_alpha, fl_N, ar_A, ar_alpha, fl_N_agg, fl_rho){</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scalar value that are row-specific, in dataframe already: *fl_A*, *fl_alpha*, *fl_N*</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># array and scalars not in dataframe, common all rows: *ar_A*, *ar_alpha*, *fl_N_agg*, *fl_rho*</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Test Parameters</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ar_A = ar_nN_A</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ar_alpha = ar_nN_alpha</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fl_N = 100</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fl_rho = -1</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fl_N_q = 10</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply Function</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  ar_p1_s1 <span class="ot">=</span> <span class="fu">exp</span>((fl_A <span class="sc">-</span> ar_A)<span class="sc">*</span>fl_rho)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  ar_p1_s2 <span class="ot">=</span> (fl_alpha<span class="sc">/</span>ar_alpha)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  ar_p1_s3 <span class="ot">=</span> (<span class="dv">1</span><span class="sc">/</span>(ar_alpha<span class="sc">*</span>fl_rho <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  ar_p1 <span class="ot">=</span> (ar_p1_s1<span class="sc">*</span>ar_p1_s2)<span class="sc">^</span>ar_p1_s3</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  ar_p2 <span class="ot">=</span> fl_N<span class="sc">^</span>((fl_alpha<span class="sc">*</span>fl_rho<span class="dv">-1</span>)<span class="sc">/</span>(ar_alpha<span class="sc">*</span>fl_rho<span class="dv">-1</span>))</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  ar_overall <span class="ot">=</span> ar_p1<span class="sc">*</span>ar_p2</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  fl_overall <span class="ot">=</span> fl_N_agg <span class="sc">-</span> <span class="fu">sum</span>(ar_overall)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(fl_overall)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="step-by-step-implmentation-of-algorithm" class="section level1">
<h1>Step by Step Implmentation of Algorithm</h1>
<p>Generate New columns of a and b as we iteratre, do not need to store p, p is temporary. Evaluate the function below which we have already tested, but now, in the dataframe before generating all permutations, <em>tb_states_choices</em>, now the <em>fl_N</em> element will be changing with each iteration, it will be row specific. <em>fl_N</em> are first min and max, then each subsequent ps.</p>
<div id="initialize-matrix" class="section level2">
<h2>Initialize Matrix</h2>
<p>First, initialize the matrix with <span class="math inline">\(a_0\)</span> and <span class="math inline">\(b_0\)</span>, the initial min and max points:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># common prefix to make reshaping easier</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>st_bisec_prefix <span class="ot">&lt;-</span> <span class="st">&#39;bisec_&#39;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>svr_a_lst <span class="ot">&lt;-</span> <span class="fu">paste0</span>(st_bisec_prefix, <span class="st">&#39;a_0&#39;</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>svr_b_lst <span class="ot">&lt;-</span> <span class="fu">paste0</span>(st_bisec_prefix, <span class="st">&#39;b_0&#39;</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>svr_fa_lst <span class="ot">&lt;-</span> <span class="fu">paste0</span>(st_bisec_prefix, <span class="st">&#39;fa_0&#39;</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>svr_fb_lst <span class="ot">&lt;-</span> <span class="fu">paste0</span>(st_bisec_prefix, <span class="st">&#39;fb_0&#39;</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Add initial a and b</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>tb_states_choices_bisec <span class="ot">&lt;-</span> tb_states_choices <span class="sc">%&gt;%</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">mutate</span>(<span class="sc">!!</span><span class="fu">sym</span>(svr_a_lst) <span class="sc">:</span><span class="er">=</span> fl_N_min, <span class="sc">!!</span><span class="fu">sym</span>(svr_b_lst) <span class="sc">:</span><span class="er">=</span> fl_N_agg)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate function f(a_0) and f(b_0)</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>tb_states_choices_bisec <span class="ot">&lt;-</span> tb_states_choices_bisec <span class="sc">%&gt;%</span> <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">mutate</span>(<span class="sc">!!</span><span class="fu">sym</span>(svr_fa_lst) <span class="sc">:</span><span class="er">=</span> <span class="fu">ffi_nonlin_dplyrdo</span>(fl_A, fl_alpha, <span class="sc">!!</span><span class="fu">sym</span>(svr_a_lst),</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>                                                                          ar_nN_A, ar_nN_alpha,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>                                                                          fl_N_agg, fl_rho),</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>                                   <span class="sc">!!</span><span class="fu">sym</span>(svr_fb_lst) <span class="sc">:</span><span class="er">=</span> <span class="fu">ffi_nonlin_dplyrdo</span>(fl_A, fl_alpha, <span class="sc">!!</span><span class="fu">sym</span>(svr_b_lst),</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>                                                                          ar_nN_A, ar_nN_alpha,</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>                                                                          fl_N_agg, fl_rho))</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(tb_states_choices_bisec)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 9 7</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tb_states_choices_bisec)</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     INDI_ID       fl_A       fl_alpha     bisec_a_0   bisec_b_0     bisec_fa_0 </span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Min.   :1   Min.   :-2   Min.   :0.1   Min.   :0   Min.   :100   Min.   :100  </span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1st Qu.:3   1st Qu.:-1   1st Qu.:0.3   1st Qu.:0   1st Qu.:100   1st Qu.:100  </span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Median :5   Median : 0   Median :0.5   Median :0   Median :100   Median :100  </span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Mean   :5   Mean   : 0   Mean   :0.5   Mean   :0   Mean   :100   Mean   :100  </span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.:7   3rd Qu.: 1   3rd Qu.:0.7   3rd Qu.:0   3rd Qu.:100   3rd Qu.:100  </span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Max.   :9   Max.   : 2   Max.   :0.9   Max.   :0   Max.   :100   Max.   :100  </span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    bisec_fb_0      </span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Min.   :-24328.4  </span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1st Qu.: -4157.8  </span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Median : -1386.7  </span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Mean   : -4737.0  </span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.:  -538.0  </span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Max.   :  -202.9</span></span></code></pre></div>
</div>
<div id="iterate-and-solve-for-fp-update-fa-and-fb" class="section level2">
<h2>Iterate and Solve for f(p), update f(a) and f(b)</h2>
<p>Implement the DPLYR based Concurrent bisection algorithm.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># fl_tol = float tolerance criteria</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># it_tol = number of interations to allow at most</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>fl_tol <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^-</span><span class="dv">2</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>it_tol <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># fl_p_dist2zr = distance to zero to initalize</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>fl_p_dist2zr <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>it_cur <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (it_cur <span class="sc">&lt;=</span> it_tol <span class="sc">&amp;&amp;</span> fl_p_dist2zr <span class="sc">&gt;=</span> fl_tol ) {</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  it_cur <span class="ot">&lt;-</span> it_cur <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># New Variables</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  svr_a_cur <span class="ot">&lt;-</span> <span class="fu">paste0</span>(st_bisec_prefix, <span class="st">&#39;a_&#39;</span>, it_cur)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  svr_b_cur <span class="ot">&lt;-</span> <span class="fu">paste0</span>(st_bisec_prefix, <span class="st">&#39;b_&#39;</span>, it_cur)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  svr_fa_cur <span class="ot">&lt;-</span> <span class="fu">paste0</span>(st_bisec_prefix, <span class="st">&#39;fa_&#39;</span>, it_cur)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  svr_fb_cur <span class="ot">&lt;-</span> <span class="fu">paste0</span>(st_bisec_prefix, <span class="st">&#39;fb_&#39;</span>, it_cur)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Evaluate function f(a_0) and f(b_0)</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1. generate p</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2. generate f_p</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 3. generate f_p*f_a</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>  tb_states_choices_bisec <span class="ot">&lt;-</span> tb_states_choices_bisec <span class="sc">%&gt;%</span> <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mutate</span>(<span class="at">p =</span> ((<span class="sc">!!</span><span class="fu">sym</span>(svr_a_lst) <span class="sc">+</span> <span class="sc">!!</span><span class="fu">sym</span>(svr_b_lst))<span class="sc">/</span><span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mutate</span>(<span class="at">f_p =</span> <span class="fu">ffi_nonlin_dplyrdo</span>(fl_A, fl_alpha, p,</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>                                                              ar_nN_A, ar_nN_alpha,</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>                                                              fl_N_agg, fl_rho)) <span class="sc">%&gt;%</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mutate</span>(<span class="at">f_p_t_f_a =</span> f_p<span class="sc">*!!</span><span class="fu">sym</span>(svr_fa_lst))</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fl_p_dist2zr = sum(abs(p))</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>  fl_p_dist2zr <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(tb_states_choices_bisec <span class="sc">%&gt;%</span> <span class="fu">pull</span>(f_p)))</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update a and b</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>  tb_states_choices_bisec <span class="ot">&lt;-</span> tb_states_choices_bisec <span class="sc">%&gt;%</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mutate</span>(<span class="sc">!!</span><span class="fu">sym</span>(svr_a_cur) <span class="sc">:</span><span class="er">=</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">case_when</span>(f_p_t_f_a <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="sc">!!</span><span class="fu">sym</span>(svr_a_lst),</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>                                                 <span class="cn">TRUE</span> <span class="sc">~</span> p)) <span class="sc">%&gt;%</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mutate</span>(<span class="sc">!!</span><span class="fu">sym</span>(svr_b_cur) <span class="sc">:</span><span class="er">=</span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">case_when</span>(f_p_t_f_a <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> p,</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>                                                 <span class="cn">TRUE</span> <span class="sc">~</span> <span class="sc">!!</span><span class="fu">sym</span>(svr_b_lst)))</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update f(a) and f(b)</span></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>  tb_states_choices_bisec <span class="ot">&lt;-</span> tb_states_choices_bisec <span class="sc">%&gt;%</span></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mutate</span>(<span class="sc">!!</span><span class="fu">sym</span>(svr_fa_cur) <span class="sc">:</span><span class="er">=</span></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">case_when</span>(f_p_t_f_a <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="sc">!!</span><span class="fu">sym</span>(svr_fa_lst),</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>                                                 <span class="cn">TRUE</span> <span class="sc">~</span> f_p)) <span class="sc">%&gt;%</span></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mutate</span>(<span class="sc">!!</span><span class="fu">sym</span>(svr_fb_cur) <span class="sc">:</span><span class="er">=</span></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">case_when</span>(f_p_t_f_a <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> f_p,</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>                                                 <span class="cn">TRUE</span> <span class="sc">~</span> <span class="sc">!!</span><span class="fu">sym</span>(svr_fb_lst)))</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Save from last</span></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>  svr_a_lst <span class="ot">&lt;-</span> svr_a_cur</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>  svr_b_lst <span class="ot">&lt;-</span> svr_b_cur</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>  svr_fa_lst <span class="ot">&lt;-</span> svr_fa_cur</span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>  svr_fb_lst <span class="ot">&lt;-</span> svr_fb_cur</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Summar current round</span></span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;it_cur:&#39;</span>, it_cur, <span class="st">&#39;, fl_p_dist2zr:&#39;</span>, fl_p_dist2zr))</span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(tb_states_choices_bisec <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">one_of</span>(svr_a_cur, svr_b_cur, svr_fa_cur, svr_fb_cur)))</span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;it_cur:1, fl_p_dist2zr:2110.89580734824&quot;</span></span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;it_cur:2, fl_p_dist2zr:916.745756204857&quot;</span></span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;it_cur:3, fl_p_dist2zr:387.351245210125&quot;</span></span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;it_cur:4, fl_p_dist2zr:155.209641366984&quot;</span></span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;it_cur:5, fl_p_dist2zr:58.1570911334532&quot;</span></span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;it_cur:6, fl_p_dist2zr:22.2118416173139&quot;</span></span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;it_cur:7, fl_p_dist2zr:8.74989971240847&quot;</span></span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;it_cur:8, fl_p_dist2zr:7.15872428611325&quot;</span></span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;it_cur:9, fl_p_dist2zr:3.58472422897695&quot;</span></span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;it_cur:10, fl_p_dist2zr:1.50543493747611&quot;</span></span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;it_cur:11, fl_p_dist2zr:0.527052368572328&quot;</span></span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;it_cur:12, fl_p_dist2zr:0.360171292121815&quot;</span></span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;it_cur:13, fl_p_dist2zr:0.0545239655746409&quot;</span></span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;it_cur:14, fl_p_dist2zr:0.152964071033218&quot;</span></span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;it_cur:15, fl_p_dist2zr:0.0593547942434943&quot;</span></span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;it_cur:16, fl_p_dist2zr:0.030716694397913&quot;</span></span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;it_cur:17, fl_p_dist2zr:0.0177772298500779&quot;</span></span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;it_cur:18, fl_p_dist2zr:0.00644396015251105&quot;</span></span></code></pre></div>
</div>
<div id="reshape-wide-to-long-to-wide" class="section level2">
<h2>Reshape Wide to long to Wide</h2>
<p>To view results easily, how iterations improved to help us find the roots, convert table from wide to long. Pivot twice. This allows us to easily graph out how bisection is working out iterationby iteration.</p>
<p>Here, we will first show what the raw table looks like, the wide only table, and then show the long version, and finally the version that is medium wide.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># New variables</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>svr_bisect_iter <span class="ot">&lt;-</span> <span class="st">&#39;biseciter&#39;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>svr_abfafb_long_name <span class="ot">&lt;-</span> <span class="st">&#39;varname&#39;</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>svr_number_col <span class="ot">&lt;-</span> <span class="st">&#39;value&#39;</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>svr_id_bisect_iter <span class="ot">&lt;-</span> <span class="fu">paste0</span>(svr_id_var, <span class="st">&#39;_bisect_ier&#39;</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Pivot wide to very long</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>tb_states_choices_bisec_long <span class="ot">&lt;-</span> tb_states_choices_bisec <span class="sc">%&gt;%</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">starts_with</span>(st_bisec_prefix),</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="fu">c</span>(svr_abfafb_long_name, svr_bisect_iter),</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_pattern =</span> <span class="fu">paste0</span>(st_bisec_prefix, <span class="st">&quot;(.*)_(.*)&quot;</span>),</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> svr_number_col</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Print</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tb_states_choices_bisec_long)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     INDI_ID       fl_A       fl_alpha         p                f_p            </span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Min.   :1   Min.   :-2   Min.   :0.1   Min.   : 0.8427   Min.   :-1.874e-02  </span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1st Qu.:3   1st Qu.:-1   1st Qu.:0.3   1st Qu.: 3.3298   1st Qu.:-2.887e-03  </span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Median :5   Median : 0   Median :0.5   Median : 7.7381   Median : 1.987e-05  </span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Mean   :5   Mean   : 0   Mean   :0.5   Mean   :11.1111   Mean   :-2.921e-04  </span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.:7   3rd Qu.: 1   3rd Qu.:0.7   3rd Qu.:15.8810   3rd Qu.: 2.626e-03  </span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Max.   :9   Max.   : 2   Max.   :0.9   Max.   :31.5121   Max.   : 2.000e-02  </span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    f_p_t_f_a            varname           biseciter        </span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Min.   :-6.210e-04   Length:684         Length:684        </span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1st Qu.:-6.641e-06   Class :character   Class :character  </span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Median : 2.350e-08   Mode  :character   Mode  :character  </span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Mean   : 2.613e-05                                        </span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.: 2.393e-05                                        </span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Max.   : 8.464e-04                                        </span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      value           </span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Min.   :-24328.416  </span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1st Qu.:     0.000  </span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Median :     1.917  </span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Mean   :   -97.563  </span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.:    15.674  </span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Max.   :   100.000</span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tb_states_choices_bisec_long <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">one_of</span>(<span class="st">&#39;p&#39;</span>,<span class="st">&#39;f_p&#39;</span>,<span class="st">&#39;f_p_t_f_a&#39;</span>)), <span class="dv">30</span>)</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 30 x 6</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    INDI_ID  fl_A fl_alpha varname biseciter   value</span></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      &lt;int&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;       &lt;dbl&gt;</span></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1       1    -2      0.1 a       0              0 </span></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2       1    -2      0.1 b       0            100 </span></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3       1    -2      0.1 fa      0            100 </span></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4       1    -2      0.1 fb      0         -24328.</span></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5       1    -2      0.1 a       1              0 </span></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6       1    -2      0.1 b       1             50 </span></span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7       1    -2      0.1 fa      1            100 </span></span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8       1    -2      0.1 fb      1         -10867.</span></span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9       1    -2      0.1 a       2              0 </span></span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10       1    -2      0.1 b       2             25 </span></span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ... with 20 more rows</span></span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(tb_states_choices_bisec_long <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">one_of</span>(<span class="st">&#39;p&#39;</span>,<span class="st">&#39;f_p&#39;</span>,<span class="st">&#39;f_p_t_f_a&#39;</span>)), <span class="dv">30</span>)</span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 30 x 6</span></span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    INDI_ID  fl_A fl_alpha varname biseciter   value</span></span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      &lt;int&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;       &lt;dbl&gt;</span></span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1       9     2      0.9 fa      11         0.0546</span></span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2       9     2      0.9 fb      11        -0.0940</span></span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3       9     2      0.9 a       12        31.5   </span></span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4       9     2      0.9 b       12        31.5   </span></span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5       9     2      0.9 fa      12         0.0546</span></span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6       9     2      0.9 fb      12        -0.0197</span></span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7       9     2      0.9 a       13        31.5   </span></span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8       9     2      0.9 b       13        31.5   </span></span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9       9     2      0.9 fa      13         0.0174</span></span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10       9     2      0.9 fb      13        -0.0197</span></span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ... with 20 more rows</span></span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Pivot wide to very long to a little wide</span></span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a>tb_states_choices_bisec_wider <span class="ot">&lt;-</span> tb_states_choices_bisec_long <span class="sc">%&gt;%</span></span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> <span class="sc">!!</span><span class="fu">sym</span>(svr_abfafb_long_name),</span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> svr_number_col</span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Note: Using an external vector in selections is ambiguous.</span></span>
<span id="cb6-77"><a href="#cb6-77" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; i Use `all_of(svr_number_col)` instead of `svr_number_col` to silence this message.</span></span>
<span id="cb6-78"><a href="#cb6-78" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; i See &lt;https://tidyselect.r-lib.org/reference/faq-external-vector.html&gt;.</span></span>
<span id="cb6-79"><a href="#cb6-79" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; This message is displayed once per session.</span></span>
<span id="cb6-80"><a href="#cb6-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-81"><a href="#cb6-81" aria-hidden="true" tabindex="-1"></a><span class="co"># Print</span></span>
<span id="cb6-82"><a href="#cb6-82" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tb_states_choices_bisec_wider)</span>
<span id="cb6-83"><a href="#cb6-83" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     INDI_ID       fl_A       fl_alpha         p                f_p            </span></span>
<span id="cb6-84"><a href="#cb6-84" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Min.   :1   Min.   :-2   Min.   :0.1   Min.   : 0.8427   Min.   :-1.874e-02  </span></span>
<span id="cb6-85"><a href="#cb6-85" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1st Qu.:3   1st Qu.:-1   1st Qu.:0.3   1st Qu.: 3.3298   1st Qu.:-2.887e-03  </span></span>
<span id="cb6-86"><a href="#cb6-86" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Median :5   Median : 0   Median :0.5   Median : 7.7381   Median : 1.987e-05  </span></span>
<span id="cb6-87"><a href="#cb6-87" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Mean   :5   Mean   : 0   Mean   :0.5   Mean   :11.1111   Mean   :-2.921e-04  </span></span>
<span id="cb6-88"><a href="#cb6-88" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.:7   3rd Qu.: 1   3rd Qu.:0.7   3rd Qu.:15.8810   3rd Qu.: 2.626e-03  </span></span>
<span id="cb6-89"><a href="#cb6-89" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Max.   :9   Max.   : 2   Max.   :0.9   Max.   :31.5121   Max.   : 2.000e-02  </span></span>
<span id="cb6-90"><a href="#cb6-90" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    f_p_t_f_a           biseciter               a                 b           </span></span>
<span id="cb6-91"><a href="#cb6-91" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Min.   :-6.210e-04   Length:171         Min.   : 0.0000   Min.   :  0.8427  </span></span>
<span id="cb6-92"><a href="#cb6-92" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1st Qu.:-6.641e-06   Class :character   1st Qu.: 0.8057   1st Qu.:  5.2093  </span></span>
<span id="cb6-93"><a href="#cb6-93" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Median : 2.350e-08   Mode  :character   Median : 5.2002   Median : 11.7188  </span></span>
<span id="cb6-94"><a href="#cb6-94" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Mean   : 2.613e-05                      Mean   : 8.9430   Mean   : 19.4693  </span></span>
<span id="cb6-95"><a href="#cb6-95" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.: 2.393e-05                      3rd Qu.:15.6250   3rd Qu.: 25.0000  </span></span>
<span id="cb6-96"><a href="#cb6-96" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Max.   : 8.464e-04                      Max.   :31.5121   Max.   :100.0000  </span></span>
<span id="cb6-97"><a href="#cb6-97" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        fa                  fb            </span></span>
<span id="cb6-98"><a href="#cb6-98" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Min.   :  0.00002   Min.   :-24328.416  </span></span>
<span id="cb6-99"><a href="#cb6-99" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1st Qu.:  0.04899   1st Qu.:   -45.805  </span></span>
<span id="cb6-100"><a href="#cb6-100" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Median :  0.79745   Median :    -1.329  </span></span>
<span id="cb6-101"><a href="#cb6-101" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Mean   : 25.85998   Mean   :  -444.523  </span></span>
<span id="cb6-102"><a href="#cb6-102" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.: 21.38681   3rd Qu.:    -0.064  </span></span>
<span id="cb6-103"><a href="#cb6-103" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Max.   :100.00000   Max.   :     0.000</span></span>
<span id="cb6-104"><a href="#cb6-104" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tb_states_choices_bisec_wider <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">one_of</span>(<span class="st">&#39;p&#39;</span>,<span class="st">&#39;f_p&#39;</span>,<span class="st">&#39;f_p_t_f_a&#39;</span>)), <span class="dv">30</span>)</span>
<span id="cb6-105"><a href="#cb6-105" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 30 x 8</span></span>
<span id="cb6-106"><a href="#cb6-106" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    INDI_ID  fl_A fl_alpha biseciter     a       b     fa       fb</span></span>
<span id="cb6-107"><a href="#cb6-107" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      &lt;int&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span id="cb6-108"><a href="#cb6-108" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1       1    -2      0.1 0         0     100     100    -24328. </span></span>
<span id="cb6-109"><a href="#cb6-109" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2       1    -2      0.1 1         0      50     100    -10867. </span></span>
<span id="cb6-110"><a href="#cb6-110" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3       1    -2      0.1 2         0      25     100     -4828. </span></span>
<span id="cb6-111"><a href="#cb6-111" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4       1    -2      0.1 3         0      12.5   100     -2117. </span></span>
<span id="cb6-112"><a href="#cb6-112" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5       1    -2      0.1 4         0       6.25  100      -898. </span></span>
<span id="cb6-113"><a href="#cb6-113" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6       1    -2      0.1 5         0       3.12  100      -350. </span></span>
<span id="cb6-114"><a href="#cb6-114" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7       1    -2      0.1 6         0       1.56  100      -103. </span></span>
<span id="cb6-115"><a href="#cb6-115" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8       1    -2      0.1 7         0.781   1.56    8.29   -103. </span></span>
<span id="cb6-116"><a href="#cb6-116" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9       1    -2      0.1 8         0.781   1.17    8.29    -46.0</span></span>
<span id="cb6-117"><a href="#cb6-117" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10       1    -2      0.1 9         0.781   0.977   8.29    -18.4</span></span>
<span id="cb6-118"><a href="#cb6-118" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ... with 20 more rows</span></span>
<span id="cb6-119"><a href="#cb6-119" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(tb_states_choices_bisec_wider <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">one_of</span>(<span class="st">&#39;p&#39;</span>,<span class="st">&#39;f_p&#39;</span>,<span class="st">&#39;f_p_t_f_a&#39;</span>)), <span class="dv">30</span>)</span>
<span id="cb6-120"><a href="#cb6-120" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 30 x 8</span></span>
<span id="cb6-121"><a href="#cb6-121" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    INDI_ID  fl_A fl_alpha biseciter     a     b      fa         fb</span></span>
<span id="cb6-122"><a href="#cb6-122" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      &lt;int&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span id="cb6-123"><a href="#cb6-123" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1       8   1.5      0.8 8          22.3  22.7 0.579   -1.13     </span></span>
<span id="cb6-124"><a href="#cb6-124" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2       8   1.5      0.8 9          22.3  22.5 0.579   -0.278    </span></span>
<span id="cb6-125"><a href="#cb6-125" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3       8   1.5      0.8 10         22.4  22.5 0.150   -0.278    </span></span>
<span id="cb6-126"><a href="#cb6-126" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4       8   1.5      0.8 11         22.4  22.4 0.150   -0.0636   </span></span>
<span id="cb6-127"><a href="#cb6-127" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5       8   1.5      0.8 12         22.4  22.4 0.0434  -0.0636   </span></span>
<span id="cb6-128"><a href="#cb6-128" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6       8   1.5      0.8 13         22.4  22.4 0.0434  -0.0101   </span></span>
<span id="cb6-129"><a href="#cb6-129" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7       8   1.5      0.8 14         22.4  22.4 0.0167  -0.0101   </span></span>
<span id="cb6-130"><a href="#cb6-130" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8       8   1.5      0.8 15         22.4  22.4 0.00327 -0.0101   </span></span>
<span id="cb6-131"><a href="#cb6-131" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9       8   1.5      0.8 16         22.4  22.4 0.00327 -0.00342  </span></span>
<span id="cb6-132"><a href="#cb6-132" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10       8   1.5      0.8 17         22.4  22.4 0.00327 -0.0000761</span></span>
<span id="cb6-133"><a href="#cb6-133" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ... with 20 more rows</span></span></code></pre></div>
</div>
<div id="graph-bisection-iteration-results" class="section level2">
<h2>Graph Bisection Iteration Results</h2>
<p>Actually we want to graph based on the long results, not the wider. Wider easier to view in table.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Graph results</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>lineplot <span class="ot">&lt;-</span> tb_states_choices_bisec_long <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="sc">!!</span><span class="fu">sym</span>(svr_bisect_iter) <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(<span class="sc">!!</span><span class="fu">sym</span>(svr_bisect_iter))) <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!!</span><span class="fu">sym</span>(svr_abfafb_long_name) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="sc">!!</span><span class="fu">sym</span>(svr_bisect_iter), <span class="at">y=</span><span class="sc">!!</span><span class="fu">sym</span>(svr_number_col),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">colour=</span><span class="sc">!!</span><span class="fu">sym</span>(svr_abfafb_long_name),</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype=</span><span class="sc">!!</span><span class="fu">sym</span>(svr_abfafb_long_name),</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">shape=</span><span class="sc">!!</span><span class="fu">sym</span>(svr_abfafb_long_name))) <span class="sc">+</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">facet_wrap</span>( <span class="sc">~</span> INDI_ID) <span class="sc">+</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Bisection Iteration over individuals Until Convergence&#39;</span>,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> <span class="st">&#39;Bisection Iteration&#39;</span>,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> <span class="st">&#39;a (left side point) and b (right side point) values&#39;</span>,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">&#39;DPLYR concurrent bisection nonlinear multple individuals&#39;</span>) <span class="sc">+</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(lineplot)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="implement-bisection-as-a-function-over-dataframe" class="section level1">
<h1>Implement Bisection as A Function over Dataframe</h1>
<div id="define-bisection-algorithm-function" class="section level2">
<h2>Define Bisection Algorithm Function</h2>
<p>Note the <em>df</em> input must have the not hard-coded input variables in <em>fc_withroot</em>, identical names. In particular, <em>svr_bisect_solu</em> should specify the name of the root variable: the x variable, which we are changing to solve for zero, whatever it is called in the <em>df</em> dataframe.</p>
<p>Inputs:</p>
<ul>
<li><em>ls_svr_df_in_func</em>: string list of variables in df that are inputs for fc_withroot.</li>
<li><em>svr_root_x</em>: the x variable name that appears n fc_withroot.</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>fv_opti_bisect_pmap_multi_test <span class="ot">&lt;-</span> <span class="cf">function</span>(df, fc_withroot,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                                           fl_lower_x, fl_upper_x,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                                           ls_svr_df_in_func,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">svr_root_x =</span> <span class="st">&#39;x&#39;</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">it_iter_tol =</span> <span class="dv">50</span>, <span class="at">fl_zero_tol =</span> <span class="dv">10</span><span class="sc">^-</span><span class="dv">5</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">bl_keep_iter =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">st_bisec_prefix =</span> <span class="st">&#39;bisec_&#39;</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">st_lower_x =</span> <span class="st">&#39;a&#39;</span>, <span class="at">st_lower_fx =</span> <span class="st">&#39;fa&#39;</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">st_upper_x =</span> <span class="st">&#39;b&#39;</span>, <span class="at">st_upper_fx =</span> <span class="st">&#39;fb&#39;</span>) {</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co"># A. common prefix to make reshaping easier</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>svr_a_lst <span class="ot">&lt;-</span> <span class="fu">paste0</span>(st_bisec_prefix, st_lower_x, <span class="st">&#39;_0&#39;</span>)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>svr_b_lst <span class="ot">&lt;-</span> <span class="fu">paste0</span>(st_bisec_prefix, st_upper_x, <span class="st">&#39;_0&#39;</span>)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>svr_fa_lst <span class="ot">&lt;-</span> <span class="fu">paste0</span>(st_bisec_prefix, st_lower_fx, <span class="st">&#39;_0&#39;</span>)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>svr_fb_lst <span class="ot">&lt;-</span> <span class="fu">paste0</span>(st_bisec_prefix, st_upper_fx, <span class="st">&#39;_0&#39;</span>)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>svr_fxvr_name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;f&#39;</span>, svr_root_x)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>ls_pmap_vars <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(ls_svr_df_in_func, svr_root_x))</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="co"># B. Add initial a and b</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>df_bisec <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="sc">!!</span><span class="fu">sym</span>(svr_a_lst) <span class="sc">:</span><span class="er">=</span> fl_lower_x, <span class="sc">!!</span><span class="fu">sym</span>(svr_b_lst) <span class="sc">:</span><span class="er">=</span> fl_upper_x)</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="co"># C. Evaluate function f(a_0) and f(b_0)</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. set x = a_0</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. evaluate f(a_0)</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. set x = b_0</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. evaluate f(b_0)</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>df_bisec <span class="ot">&lt;-</span> df_bisec <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="sc">!!</span><span class="fu">sym</span>(svr_root_x) <span class="sc">:</span><span class="er">=</span> <span class="sc">!!</span><span class="fu">sym</span>(svr_a_lst))</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>df_bisec <span class="ot">&lt;-</span> df_bisec <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>                <span class="sc">!!</span><span class="fu">sym</span>(svr_fa_lst) <span class="sc">:</span><span class="er">=</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">unlist</span>(</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">pmap</span>(df_bisec <span class="sc">%&gt;%</span> <span class="fu">select</span>(ls_pmap_vars), fc_withroot)</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>                    )</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>df_bisec <span class="ot">&lt;-</span> df_bisec <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="sc">!!</span><span class="fu">sym</span>(svr_root_x) <span class="sc">:</span><span class="er">=</span> <span class="sc">!!</span><span class="fu">sym</span>(svr_b_lst))</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>df_bisec <span class="ot">&lt;-</span> df_bisec <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>                <span class="sc">!!</span><span class="fu">sym</span>(svr_fb_lst) <span class="sc">:</span><span class="er">=</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">unlist</span>(</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">pmap</span>(df_bisec <span class="sc">%&gt;%</span> <span class="fu">select</span>(ls_pmap_vars), fc_withroot)</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>                    )</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a><span class="co"># D. Iteration Convergence Criteria</span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a><span class="co"># fl_p_dist2zr = distance to zero to initalize</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>fl_p_dist2zr <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>it_cur <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (it_cur <span class="sc">&lt;=</span> it_iter_tol <span class="sc">&amp;&amp;</span> fl_p_dist2zr <span class="sc">&gt;=</span> fl_zero_tol ) {</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>  it_cur <span class="ot">&lt;-</span> it_cur <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>  <span class="co"># New Variables</span></span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>  svr_a_cur <span class="ot">&lt;-</span> <span class="fu">paste0</span>(st_bisec_prefix, st_lower_x, <span class="st">&#39;_&#39;</span>, it_cur)</span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>  svr_b_cur <span class="ot">&lt;-</span> <span class="fu">paste0</span>(st_bisec_prefix, st_upper_x, <span class="st">&#39;_&#39;</span>, it_cur)</span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>  svr_fa_cur <span class="ot">&lt;-</span> <span class="fu">paste0</span>(st_bisec_prefix, st_lower_fx, <span class="st">&#39;_&#39;</span>, it_cur)</span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>  svr_fb_cur <span class="ot">&lt;-</span> <span class="fu">paste0</span>(st_bisec_prefix, st_upper_fx, <span class="st">&#39;_&#39;</span>, it_cur)</span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Evaluate function f(a_0) and f(b_0)</span></span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1. generate p</span></span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2. generate f_p</span></span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 3. generate f_p*f_a</span></span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a>  df_bisec <span class="ot">&lt;-</span> df_bisec <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="sc">!!</span><span class="fu">sym</span>(svr_root_x) <span class="sc">:</span><span class="er">=</span> ((<span class="sc">!!</span><span class="fu">sym</span>(svr_a_lst) <span class="sc">+</span> <span class="sc">!!</span><span class="fu">sym</span>(svr_b_lst))<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a>  df_bisec <span class="ot">&lt;-</span> df_bisec <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a>                  <span class="sc">!!</span><span class="fu">sym</span>(svr_fxvr_name) <span class="sc">:</span><span class="er">=</span></span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">unlist</span>(</span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">pmap</span>(df_bisec <span class="sc">%&gt;%</span> <span class="fu">select</span>(ls_pmap_vars), fc_withroot)</span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a>                  ) <span class="sc">%&gt;%</span></span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">mutate</span>(<span class="at">f_p_t_f_a =</span> <span class="sc">!!</span><span class="fu">sym</span>(svr_fxvr_name)<span class="sc">*!!</span><span class="fu">sym</span>(svr_fa_lst))</span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fl_p_dist2zr = sum(abs(p))</span></span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a>  fl_p_dist2zr <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(df_bisec <span class="sc">%&gt;%</span> <span class="fu">pull</span>(<span class="sc">!!</span><span class="fu">sym</span>(svr_fxvr_name))))</span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update a and b</span></span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a>  df_bisec <span class="ot">&lt;-</span> df_bisec <span class="sc">%&gt;%</span></span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">mutate</span>(<span class="sc">!!</span><span class="fu">sym</span>(svr_a_cur) <span class="sc">:</span><span class="er">=</span></span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">case_when</span>(f_p_t_f_a <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="sc">!!</span><span class="fu">sym</span>(svr_a_lst),</span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a>                                     <span class="cn">TRUE</span> <span class="sc">~</span> <span class="sc">!!</span><span class="fu">sym</span>(svr_root_x))) <span class="sc">%&gt;%</span></span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">mutate</span>(<span class="sc">!!</span><span class="fu">sym</span>(svr_b_cur) <span class="sc">:</span><span class="er">=</span></span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">case_when</span>(f_p_t_f_a <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="sc">!!</span><span class="fu">sym</span>(svr_root_x),</span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a>                                     <span class="cn">TRUE</span> <span class="sc">~</span> <span class="sc">!!</span><span class="fu">sym</span>(svr_b_lst)))</span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update f(a) and f(b)</span></span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true" tabindex="-1"></a>  df_bisec <span class="ot">&lt;-</span> df_bisec <span class="sc">%&gt;%</span></span>
<span id="cb8-84"><a href="#cb8-84" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">mutate</span>(<span class="sc">!!</span><span class="fu">sym</span>(svr_fa_cur) <span class="sc">:</span><span class="er">=</span></span>
<span id="cb8-85"><a href="#cb8-85" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">case_when</span>(f_p_t_f_a <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="sc">!!</span><span class="fu">sym</span>(svr_fa_lst),</span>
<span id="cb8-86"><a href="#cb8-86" aria-hidden="true" tabindex="-1"></a>                                     <span class="cn">TRUE</span> <span class="sc">~</span> <span class="sc">!!</span><span class="fu">sym</span>(svr_fxvr_name))) <span class="sc">%&gt;%</span></span>
<span id="cb8-87"><a href="#cb8-87" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">mutate</span>(<span class="sc">!!</span><span class="fu">sym</span>(svr_fb_cur) <span class="sc">:</span><span class="er">=</span></span>
<span id="cb8-88"><a href="#cb8-88" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">case_when</span>(f_p_t_f_a <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="sc">!!</span><span class="fu">sym</span>(svr_fxvr_name),</span>
<span id="cb8-89"><a href="#cb8-89" aria-hidden="true" tabindex="-1"></a>                                     <span class="cn">TRUE</span> <span class="sc">~</span> <span class="sc">!!</span><span class="fu">sym</span>(svr_fb_lst)))</span>
<span id="cb8-90"><a href="#cb8-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-91"><a href="#cb8-91" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Drop past record possibly</span></span>
<span id="cb8-92"><a href="#cb8-92" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span>bl_keep_iter) {</span>
<span id="cb8-93"><a href="#cb8-93" aria-hidden="true" tabindex="-1"></a>    df_bisec <span class="ot">&lt;-</span> df_bisec <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">one_of</span>(<span class="fu">c</span>(svr_a_lst, svr_b_lst, svr_fa_lst, svr_fb_lst)))</span>
<span id="cb8-94"><a href="#cb8-94" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb8-95"><a href="#cb8-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-96"><a href="#cb8-96" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Save from last</span></span>
<span id="cb8-97"><a href="#cb8-97" aria-hidden="true" tabindex="-1"></a>  svr_a_lst <span class="ot">&lt;-</span> svr_a_cur</span>
<span id="cb8-98"><a href="#cb8-98" aria-hidden="true" tabindex="-1"></a>  svr_b_lst <span class="ot">&lt;-</span> svr_b_cur</span>
<span id="cb8-99"><a href="#cb8-99" aria-hidden="true" tabindex="-1"></a>  svr_fa_lst <span class="ot">&lt;-</span> svr_fa_cur</span>
<span id="cb8-100"><a href="#cb8-100" aria-hidden="true" tabindex="-1"></a>  svr_fb_lst <span class="ot">&lt;-</span> svr_fb_cur</span>
<span id="cb8-101"><a href="#cb8-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-102"><a href="#cb8-102" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Summar current round</span></span>
<span id="cb8-103"><a href="#cb8-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="fu">paste0</span>(<span class="st">&#39;it_cur:&#39;</span>, it_cur, <span class="st">&#39;, fl_p_dist2zr:&#39;</span>, fl_p_dist2zr))</span>
<span id="cb8-104"><a href="#cb8-104" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-105"><a href="#cb8-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-106"><a href="#cb8-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-107"><a href="#cb8-107" aria-hidden="true" tabindex="-1"></a><span class="co"># return</span></span>
<span id="cb8-108"><a href="#cb8-108" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(df_bisec)</span>
<span id="cb8-109"><a href="#cb8-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-110"><a href="#cb8-110" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="prepare-inputs-to-invoke-bisection-function" class="section level2">
<h2>Prepare Inputs to Invoke Bisection Function</h2>
<p>Here we use the same function as earlier, but modify number of parameters:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define Inputs</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> tb_states_choices</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>fc_withroot <span class="ot">&lt;-</span> <span class="cf">function</span>(fl_A, fl_alpha, x){</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Function has four inputs hardcoded in: ar_nN_A, ar_nN_alpha, fl_rho, fl_N_agg</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Also renamed fl_N to x, indicating this is the x we are shifting to look for zero.</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  ar_p1_s1 <span class="ot">=</span> <span class="fu">exp</span>((fl_A <span class="sc">-</span> ar_nN_A)<span class="sc">*</span>fl_rho)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  ar_p1_s2 <span class="ot">=</span> (fl_alpha<span class="sc">/</span>ar_nN_alpha)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  ar_p1_s3 <span class="ot">=</span> (<span class="dv">1</span><span class="sc">/</span>(ar_nN_alpha<span class="sc">*</span>fl_rho <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  ar_p1 <span class="ot">=</span> (ar_p1_s1<span class="sc">*</span>ar_p1_s2)<span class="sc">^</span>ar_p1_s3</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  ar_p2 <span class="ot">=</span> x<span class="sc">^</span>((fl_alpha<span class="sc">*</span>fl_rho<span class="dv">-1</span>)<span class="sc">/</span>(ar_nN_alpha<span class="sc">*</span>fl_rho<span class="dv">-1</span>))</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  ar_overall <span class="ot">=</span> ar_p1<span class="sc">*</span>ar_p2</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  fl_overall <span class="ot">=</span> fl_N_agg <span class="sc">-</span> <span class="fu">sum</span>(ar_overall)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(fl_overall)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>fl_lower_x <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>fl_upper_x <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>ls_svr_df_in_func <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;fl_A&#39;</span>, <span class="st">&#39;fl_alpha&#39;</span>)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>svr_root_x <span class="ot">&lt;-</span> <span class="st">&#39;x&#39;</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>fl_zero_tol <span class="ot">=</span> <span class="dv">10</span><span class="sc">^-</span><span class="dv">6</span></span></code></pre></div>
<p>Additionally, let’s prepare a very simple linear test:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>ar_intercept <span class="ot">=</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="at">length.out =</span> it_N_child_cnt)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>ar_slope <span class="ot">=</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="at">length.out =</span> it_N_child_cnt)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>df_lines <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">cbind</span>(ar_intercept, ar_slope)) <span class="sc">%&gt;%</span> <span class="fu">rowid_to_column</span>(<span class="at">var=</span><span class="st">&#39;ID&#39;</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>ar_st_col_names <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&#39;ID&#39;</span>,<span class="st">&#39;fl_int&#39;</span>, <span class="st">&#39;fl_slope&#39;</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>df_lines <span class="ot">&lt;-</span> df_lines <span class="sc">%&gt;%</span> <span class="fu">rename_all</span>(<span class="sc">~</span><span class="fu">c</span>(ar_st_col_names))</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>fc_withroot_line <span class="ot">&lt;-</span> <span class="cf">function</span>(fl_int, fl_slope, x){</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(fl_int <span class="sc">+</span> fl_slope<span class="sc">*</span>x)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>fl_lower_x_line <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>fl_upper_x_line <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>ls_svr_df_in_func_line <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;fl_int&#39;</span>, <span class="st">&#39;fl_slope&#39;</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>svr_root_x_line <span class="ot">&lt;-</span> <span class="st">&#39;x&#39;</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>fl_zero_tol <span class="ot">=</span> <span class="dv">10</span><span class="sc">^-</span><span class="dv">6</span></span></code></pre></div>
</div>
<div id="test-function" class="section level2">
<h2>Test Function</h2>
<p>Now we call the function to see if it works:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>df_bisec <span class="ot">&lt;-</span> <span class="fu">fv_opti_bisect_pmap_multi_test</span>(df, fc_withroot, fl_lower_x,fl_upper_x,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>                                           ls_svr_df_in_func, svr_root_x, <span class="at">bl_keep_iter =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Note: Using an external vector in selections is ambiguous.</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; i Use `all_of(ls_pmap_vars)` instead of `ls_pmap_vars` to silence this message.</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; i See &lt;https://tidyselect.r-lib.org/reference/faq-external-vector.html&gt;.</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; This message is displayed once per session.</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:1, fl_p_dist2zr:4736.99534218055</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:2, fl_p_dist2zr:2110.89580734824</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:3, fl_p_dist2zr:916.745756204857</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:4, fl_p_dist2zr:387.351245210125</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:5, fl_p_dist2zr:155.209641366984</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:6, fl_p_dist2zr:58.1570911334532</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:7, fl_p_dist2zr:22.2118416173139</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:8, fl_p_dist2zr:8.74989971240847</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:9, fl_p_dist2zr:7.15872428611325</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:10, fl_p_dist2zr:3.58472422897695</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:11, fl_p_dist2zr:1.50543493747611</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:12, fl_p_dist2zr:0.527052368572328</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:13, fl_p_dist2zr:0.360171292121815</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:14, fl_p_dist2zr:0.0545239655746409</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:15, fl_p_dist2zr:0.152964071033218</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:16, fl_p_dist2zr:0.0593547942434943</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:17, fl_p_dist2zr:0.030716694397913</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:18, fl_p_dist2zr:0.0177772298500779</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:19, fl_p_dist2zr:0.00644396015251105</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:20, fl_p_dist2zr:0.00242474898992384</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:21, fl_p_dist2zr:0.00163155064414077</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:22, fl_p_dist2zr:0.000398869003509124</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:23, fl_p_dist2zr:0.000450010969980023</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:24, fl_p_dist2zr:0.000192696055121486</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:25, fl_p_dist2zr:4.77090151996941e-05</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:26, fl_p_dist2zr:4.87038981494455e-05</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:27, fl_p_dist2zr:2.28095363736555e-05</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:28, fl_p_dist2zr:3.72447202165757e-06</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Do individual inputs sum up to total allocations available</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>fl_allocated <span class="ot">&lt;-</span> <span class="fu">sum</span>(df_bisec <span class="sc">%&gt;%</span> <span class="fu">pull</span>(svr_root_x))</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (fl_N_agg <span class="sc">==</span> fl_allocated){</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">&#39;Total Input Available = Sum of Optimal Individual Allocations&#39;</span>)</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;fl_N_agg =&#39;</span>, fl_N_agg, <span class="st">&#39;, but, sum(df_bisec %&gt;% pull(svr_root_x))=&#39;</span>, fl_allocated)</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; fl_N_agg = 100 , but, sum(df_bisec %&gt;% pull(svr_root_x))= 100</span></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Show all</span></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>df_bisec</span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 9 x 122</span></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   INDI_ID  fl_A fl_alpha bisec_a_0 bisec_b_0      x bisec_fa_0 bisec_fb_0</span></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     &lt;int&gt; &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1       1  -2        0.1         0       200  0.843        100    -54364.</span></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2       2  -1.5      0.2         0       200  1.92         100    -18749.</span></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3       3  -1        0.3         0       200  3.33         100     -9069.</span></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4       4  -0.5      0.4         0       200  5.21         100     -5027.</span></span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5       5   0        0.5         0       200  7.74         100     -2995.</span></span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6       6   0.5      0.6         0       200 11.2          100     -1861.</span></span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7       7   1        0.7         0       200 15.9          100     -1184.</span></span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8       8   1.5      0.8         0       200 22.4          100      -762.</span></span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9       9   2        0.9         0       200 31.5          100      -490.</span></span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ... with 114 more variables: fx &lt;dbl&gt;, f_p_t_f_a &lt;dbl&gt;, bisec_a_1 &lt;dbl&gt;,</span></span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   bisec_b_1 &lt;dbl&gt;, bisec_fa_1 &lt;dbl&gt;, bisec_fb_1 &lt;dbl&gt;, bisec_a_2 &lt;dbl&gt;,</span></span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   bisec_b_2 &lt;dbl&gt;, bisec_fa_2 &lt;dbl&gt;, bisec_fb_2 &lt;dbl&gt;, bisec_a_3 &lt;dbl&gt;,</span></span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   bisec_b_3 &lt;dbl&gt;, bisec_fa_3 &lt;dbl&gt;, bisec_fb_3 &lt;dbl&gt;, bisec_a_4 &lt;dbl&gt;,</span></span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   bisec_b_4 &lt;dbl&gt;, bisec_fa_4 &lt;dbl&gt;, bisec_fb_4 &lt;dbl&gt;, bisec_a_5 &lt;dbl&gt;,</span></span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   bisec_b_5 &lt;dbl&gt;, bisec_fa_5 &lt;dbl&gt;, bisec_fb_5 &lt;dbl&gt;, bisec_a_6 &lt;dbl&gt;,</span></span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   bisec_b_6 &lt;dbl&gt;, bisec_fa_6 &lt;dbl&gt;, bisec_fb_6 &lt;dbl&gt;, bisec_a_7 &lt;dbl&gt;,</span></span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   bisec_b_7 &lt;dbl&gt;, bisec_fa_7 &lt;dbl&gt;, bisec_fb_7 &lt;dbl&gt;, bisec_a_8 &lt;dbl&gt;,</span></span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   bisec_b_8 &lt;dbl&gt;, bisec_fa_8 &lt;dbl&gt;, bisec_fb_8 &lt;dbl&gt;, bisec_a_9 &lt;dbl&gt;,</span></span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   bisec_b_9 &lt;dbl&gt;, bisec_fa_9 &lt;dbl&gt;, bisec_fb_9 &lt;dbl&gt;, bisec_a_10 &lt;dbl&gt;,</span></span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   bisec_b_10 &lt;dbl&gt;, bisec_fa_10 &lt;dbl&gt;, bisec_fb_10 &lt;dbl&gt;, bisec_a_11 &lt;dbl&gt;,</span></span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   bisec_b_11 &lt;dbl&gt;, bisec_fa_11 &lt;dbl&gt;, bisec_fb_11 &lt;dbl&gt;, bisec_a_12 &lt;dbl&gt;,</span></span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   bisec_b_12 &lt;dbl&gt;, bisec_fa_12 &lt;dbl&gt;, bisec_fb_12 &lt;dbl&gt;, bisec_a_13 &lt;dbl&gt;,</span></span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   bisec_b_13 &lt;dbl&gt;, bisec_fa_13 &lt;dbl&gt;, bisec_fb_13 &lt;dbl&gt;, bisec_a_14 &lt;dbl&gt;,</span></span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   bisec_b_14 &lt;dbl&gt;, bisec_fa_14 &lt;dbl&gt;, bisec_fb_14 &lt;dbl&gt;, bisec_a_15 &lt;dbl&gt;,</span></span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   bisec_b_15 &lt;dbl&gt;, bisec_fa_15 &lt;dbl&gt;, bisec_fb_15 &lt;dbl&gt;, bisec_a_16 &lt;dbl&gt;,</span></span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   bisec_b_16 &lt;dbl&gt;, bisec_fa_16 &lt;dbl&gt;, bisec_fb_16 &lt;dbl&gt;, bisec_a_17 &lt;dbl&gt;,</span></span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   bisec_b_17 &lt;dbl&gt;, bisec_fa_17 &lt;dbl&gt;, bisec_fb_17 &lt;dbl&gt;, bisec_a_18 &lt;dbl&gt;,</span></span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   bisec_b_18 &lt;dbl&gt;, bisec_fa_18 &lt;dbl&gt;, bisec_fb_18 &lt;dbl&gt;, bisec_a_19 &lt;dbl&gt;,</span></span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   bisec_b_19 &lt;dbl&gt;, bisec_fa_19 &lt;dbl&gt;, bisec_fb_19 &lt;dbl&gt;, bisec_a_20 &lt;dbl&gt;,</span></span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   bisec_b_20 &lt;dbl&gt;, bisec_fa_20 &lt;dbl&gt;, bisec_fb_20 &lt;dbl&gt;, bisec_a_21 &lt;dbl&gt;,</span></span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   bisec_b_21 &lt;dbl&gt;, bisec_fa_21 &lt;dbl&gt;, bisec_fb_21 &lt;dbl&gt;, bisec_a_22 &lt;dbl&gt;,</span></span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   bisec_b_22 &lt;dbl&gt;, bisec_fa_22 &lt;dbl&gt;, bisec_fb_22 &lt;dbl&gt;, bisec_a_23 &lt;dbl&gt;,</span></span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   bisec_b_23 &lt;dbl&gt;, bisec_fa_23 &lt;dbl&gt;, bisec_fb_23 &lt;dbl&gt;, bisec_a_24 &lt;dbl&gt;,</span></span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   bisec_b_24 &lt;dbl&gt;, bisec_fa_24 &lt;dbl&gt;, bisec_fb_24 &lt;dbl&gt;, bisec_a_25 &lt;dbl&gt;,</span></span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   bisec_b_25 &lt;dbl&gt;, ...</span></span></code></pre></div>
<p>Call the same function, but do not save history:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>df_bisec <span class="ot">&lt;-</span> <span class="fu">suppressMessages</span>(<span class="fu">fv_opti_bisect_pmap_multi_test</span>(df, fc_withroot, fl_lower_x, fl_upper_x,</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                                                            ls_svr_df_in_func, svr_root_x, <span class="at">bl_keep_iter =</span> <span class="cn">FALSE</span>))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>df_bisec <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">one_of</span>(<span class="st">&#39;f_p_t_f_a&#39;</span>))</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 9 x 9</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   INDI_ID  fl_A fl_alpha      x       fx bisec_a_28 bisec_b_28 bisec_fa_28</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     &lt;int&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1       1  -2        0.1  0.843  1.35e-6      0.843      0.843 0.00000135 </span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2       2  -1.5      0.2  1.92  -1.23e-5      1.92       1.92  0.0000313  </span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3       3  -1        0.3  3.33  -9.41e-6      3.33       3.33  0.0000152  </span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4       4  -0.5      0.4  5.21  -4.38e-6      5.21       5.21  0.0000110  </span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5       5   0        0.5  7.74   5.55e-7      7.74       7.74  0.000000555</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6       6   0.5      0.6 11.2    3.55e-6     11.2       11.2   0.00000355 </span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7       7   1        0.7 15.9   -5.55e-7     15.9       15.9   0.00000416 </span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8       8   1.5      0.8 22.4   -9.41e-7     22.4       22.4   0.00000233 </span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9       9   2        0.9 31.5   -5.27e-7     31.5       31.5   0.00000174 </span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ... with 1 more variable: bisec_fb_28 &lt;dbl&gt;</span></span></code></pre></div>
<p>Call the linear root function:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>df_bisec <span class="ot">&lt;-</span> <span class="fu">fv_opti_bisect_pmap_multi_test</span>(df_lines, fc_withroot_line,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                                           fl_lower_x_line, fl_upper_x_line,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                                           ls_svr_df_in_func_line, svr_root_x_line, <span class="at">bl_keep_iter =</span> <span class="cn">FALSE</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:1, fl_p_dist2zr:27494.5</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:2, fl_p_dist2zr:13744.5</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:3, fl_p_dist2zr:6869.5</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:4, fl_p_dist2zr:3432</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:5, fl_p_dist2zr:1713.25</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:6, fl_p_dist2zr:853.875</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:7, fl_p_dist2zr:424.1875</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:8, fl_p_dist2zr:209.34375</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:9, fl_p_dist2zr:101.921875</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:10, fl_p_dist2zr:48.2630208333333</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:11, fl_p_dist2zr:22.4405381944444</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:12, fl_p_dist2zr:9.83213975694444</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:13, fl_p_dist2zr:4.24430338541667</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:14, fl_p_dist2zr:1.79055447048611</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:15, fl_p_dist2zr:0.783148871527778</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:16, fl_p_dist2zr:0.419854058159722</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:17, fl_p_dist2zr:0.137461344401042</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:18, fl_p_dist2zr:0.0981631808810763</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:19, fl_p_dist2zr:0.0471479627821184</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:20, fl_p_dist2zr:0.0238359239366318</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:21, fl_p_dist2zr:0.0155442555745441</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:22, fl_p_dist2zr:0.00779639350043383</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:23, fl_p_dist2zr:0.00397608015272343</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:24, fl_p_dist2zr:0.00209707683987107</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:25, fl_p_dist2zr:0.000747521718342902</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:26, fl_p_dist2zr:0.000320964389377071</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:27, fl_p_dist2zr:0.000268595086203484</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:28, fl_p_dist2zr:7.08483987382399e-05</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:29, fl_p_dist2zr:4.65694401001255e-05</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:30, fl_p_dist2zr:2.71068678960873e-05</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:31, fl_p_dist2zr:1.14395386645841e-05</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:32, fl_p_dist2zr:6.38038747870063e-06</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>df_bisec <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">one_of</span>(<span class="st">&#39;f_p_t_f_a&#39;</span>))</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 9 x 9</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      ID fl_int fl_slope      x       fx bisec_a_32 bisec_b_32 bisec_fa_32</span></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;int&gt;  &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     1 -10       0.1   100.   -6.89e-7     100.       100.      -6.89e-7</span></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2     2  -8.88    0.213  41.8   2.68e-6      41.8       41.8     -2.27e-6</span></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3     3  -7.75    0.325  23.8   3.72e-6      23.8       23.8     -3.85e-6</span></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4     4  -6.62    0.438  15.1   2.42e-6      15.1       15.1     -7.76e-6</span></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5     5  -5.5     0.55   10.0   3.46e-6      10.0       10.0     -9.34e-6</span></span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6     6  -4.38    0.662   6.60 -1.41e-5       6.60       6.60    -1.41e-5</span></span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7     7  -3.25    0.775   4.19 -9.60e-6       4.19       4.19    -9.60e-6</span></span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8     8  -2.12    0.888   2.39 -5.06e-6       2.39       2.39    -5.06e-6</span></span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9     9  -1       1       1.00 -1.57e-5       1.00       1.00    -1.57e-5</span></span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ... with 1 more variable: bisec_fb_32 &lt;dbl&gt;</span></span></code></pre></div>
</div>
<div id="test-with-prjoptialloc-log-results" class="section level2">
<h2>Test with PrjOptiAlloc log results</h2>
<p>Use <em>df_esti</em> from <a href="https://fanwangecon.github.io/PrjOptiAlloc/reference/df_opt_dtgch_cbem4.html"><em>ffy_opt_dtgch_cbem4</em></a> function of project <em>PrjOptiAlloc</em>. Select only the <em>fl_A</em> and <em>fl_alpha</em> variables, should look like <em>tb_states_choices</em>. The difference is that <em>tb_states_choices</em> values were made up, but the <em>alpha</em> and <em>A</em> values from <em>df_esti</em> are estimated.</p>
<p>The function is the same as before: <em>fc_withroot</em>, in fact, this function is the solution to the log linear allocation from problem <a href="https://fanwangecon.github.io/PrjOptiAlloc/">PrjOptiAlloc</a>.</p>
<p>First define the data frame:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Package and Data</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ls_opti_alpha_A &lt;- PrjOptiAlloc::ffy_opt_dtgch_cbem4()</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># df_esti &lt;- ls_opti_alpha_A$df_esti</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>df_esti <span class="ot">&lt;-</span> df_opt_dtgch_cbem4</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Select only some individuals to speed up test</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>df_esti <span class="ot">&lt;-</span> df_esti <span class="sc">%&gt;%</span> <span class="fu">filter</span>(indi.id <span class="sc">&lt;=</span> <span class="dv">10</span>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Select only A and Alpha and Index</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co"># %&gt;% mutate(A_log =(A_log))</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>df_dtgch_cbem4_bisec <span class="ot">&lt;-</span> df_esti <span class="sc">%&gt;%</span> <span class="fu">select</span>(indi.id, A_log, alpha_log)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>ar_st_col_names <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&#39;INDI_ID&#39;</span>, <span class="st">&#39;fl_A&#39;</span>, <span class="st">&#39;fl_alpha&#39;</span>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_dtgch_cbem4_bisec <span class="sc">%&gt;%</span> <span class="fu">rename_all</span>(<span class="sc">~</span><span class="fu">c</span>(ar_st_col_names))</span></code></pre></div>
<p>Crucially, also need to redefine the function, note that the function formula we are using here is the same as before, however, there are Hard-Coded vectors in the formula, that need to reflect the new dataframe.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># hard-coded parameters</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>ar_nN_A <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">pull</span>(fl_A)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>ar_nN_alpha <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">pull</span>(fl_alpha)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Function again updating the hard-coded parameters</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>fc_withroot <span class="ot">&lt;-</span> <span class="cf">function</span>(fl_A, fl_alpha, x){</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Function has four inputs hardcoded in: ar_nN_A, ar_nN_alpha, fl_rho, fl_N_agg</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Also renamed fl_N to x, indicating this is the x we are shifting to look for zero.</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  ar_p1_s1 <span class="ot">=</span> <span class="fu">exp</span>((fl_A <span class="sc">-</span> ar_nN_A)<span class="sc">*</span>fl_rho)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  ar_p1_s2 <span class="ot">=</span> (fl_alpha<span class="sc">/</span>ar_nN_alpha)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  ar_p1_s3 <span class="ot">=</span> (<span class="dv">1</span><span class="sc">/</span>(ar_nN_alpha<span class="sc">*</span>fl_rho <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  ar_p1 <span class="ot">=</span> (ar_p1_s1<span class="sc">*</span>ar_p1_s2)<span class="sc">^</span>ar_p1_s3</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  ar_p2 <span class="ot">=</span> x<span class="sc">^</span>((fl_alpha<span class="sc">*</span>fl_rho<span class="dv">-1</span>)<span class="sc">/</span>(ar_nN_alpha<span class="sc">*</span>fl_rho<span class="dv">-1</span>))</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  ar_overall <span class="ot">=</span> ar_p1<span class="sc">*</span>ar_p2</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  fl_overall <span class="ot">=</span> fl_N_agg <span class="sc">-</span> <span class="fu">sum</span>(ar_overall)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(fl_overall)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Finally call and solve with the bisection function:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bisect and Solve</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>ls_svr_df_in_func <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;fl_A&#39;</span>, <span class="st">&#39;fl_alpha&#39;</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>svr_root_x <span class="ot">&lt;-</span> <span class="st">&#39;x&#39;</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>df_bisec_dtgch_cbem4 <span class="ot">&lt;-</span> <span class="fu">fv_opti_bisect_pmap_multi_test</span>(df, fc_withroot,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>                                                       <span class="dv">0</span>, fl_upper_x,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>                                                       ls_svr_df_in_func, svr_root_x,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>                                                       <span class="at">bl_keep_iter =</span> <span class="cn">FALSE</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:1, fl_p_dist2zr:899.86958899644</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:2, fl_p_dist2zr:399.795325546567</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:3, fl_p_dist2zr:149.82803720318</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:4, fl_p_dist2zr:39.6981877915583</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:5, fl_p_dist2zr:22.7544373106979</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:6, fl_p_dist2zr:13.6648690730157</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:7, fl_p_dist2zr:4.00882580615786</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:8, fl_p_dist2zr:5.16853400177715</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:9, fl_p_dist2zr:1.51302257271096</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:10, fl_p_dist2zr:0.652943611605188</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:11, fl_p_dist2zr:0.600480528493414</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:12, fl_p_dist2zr:0.250509919781611</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:13, fl_p_dist2zr:0.0896781862774658</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:14, fl_p_dist2zr:0.0538247482166633</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:15, fl_p_dist2zr:0.0239801341471519</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:16, fl_p_dist2zr:0.0140266432007429</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:17, fl_p_dist2zr:0.00893928482057681</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:18, fl_p_dist2zr:0.00357052465549164</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:19, fl_p_dist2zr:0.00185480902755507</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:20, fl_p_dist2zr:0.0008568164157244</span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:21, fl_p_dist2zr:0.000597378694812455</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:22, fl_p_dist2zr:0.000310870384761112</span></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:23, fl_p_dist2zr:0.000106146686901651</span></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:24, fl_p_dist2zr:7.78112187778864e-05</span></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:25, fl_p_dist2zr:2.60678871689556e-05</span></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:26, fl_p_dist2zr:1.31156909364765e-05</span></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; it_cur:27, fl_p_dist2zr:9.57136451360283e-06</span></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Do individual inputs sum up to total allocations available</span></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>fl_allocated <span class="ot">&lt;-</span> <span class="fu">sum</span>(df_bisec_dtgch_cbem4 <span class="sc">%&gt;%</span> <span class="fu">pull</span>(svr_root_x))</span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (fl_N_agg <span class="sc">==</span> fl_allocated){</span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">&#39;Total Input Available = Sum of Optimal Individual Allocations&#39;</span>)</span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;fl_N_agg =&#39;</span>, fl_N_agg, <span class="st">&#39;, and, sum(df_bisec_dtgch_cbem4 %&gt;% pull(svr_root_x))=&#39;</span>, fl_allocated)</span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;fl_N_agg =&#39;</span>, fl_N_agg, <span class="st">&#39;, but, sum(df_bisec_dtgch_cbem4 %&gt;% pull(svr_root_x))=&#39;</span>, fl_allocated)</span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; fl_N_agg = 100 , but, sum(df_bisec_dtgch_cbem4 %&gt;% pull(svr_root_x))= 100</span></span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>df_bisec_dtgch_cbem4</span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 9 x 10</span></span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   INDI_ID  fl_A fl_alpha     x       fx f_p_t_f_a bisec_a_27 bisec_b_27</span></span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1       2  4.34  0.00669  7.64 -1.35e-5 -8.09e-11       7.64       7.64</span></span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2       3  4.36  0.00925 10.6   4.08e-6  7.39e-11      10.6       10.6 </span></span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3       4  4.35  0.00925 10.6   8.10e-6  1.80e-10      10.6       10.6 </span></span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4       5  4.37  0.0139  16.1  -5.42e-7 -4.72e-12      16.1       16.1 </span></span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5       6  4.34  0.00669  7.63 -1.78e-5 -3.08e-11       7.63       7.63</span></span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6       7  4.36  0.0139  16.1   5.60e-6  8.34e-11      16.1       16.1 </span></span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7       8  4.34  0.00669  7.63 -1.17e-5 -9.18e-11       7.63       7.63</span></span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8       9  4.34  0.00669  7.63  1.56e-5  5.49e-10       7.63       7.63</span></span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9      10  4.36  0.0139  16.1   9.17e-6  1.69e-10      16.1       16.1 </span></span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ... with 2 more variables: bisec_fa_27 &lt;dbl&gt;, bisec_fb_27 &lt;dbl&gt;</span></span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
