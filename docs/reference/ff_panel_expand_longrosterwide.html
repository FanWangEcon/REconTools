<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>long Panel Record Date of Attendance each ID, Expand to Wide of Cumulative Attendance by Dates — ff_panel_expand_longrosterwide • REconTools</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="long Panel Record Date of Attendance each ID, Expand to Wide of Cumulative Attendance by Dates — ff_panel_expand_longrosterwide" />
<meta property="og:description" content="INPUT MATRIX: There are $N$ students in class, but only a subset of them attend class each day.
If student $id_i$ is in class on day $Q$, the teacher records on a sheet the date
and the student ID. So if the student has been in class 10 times, the teacher has
ten rows of recorded data for the student with two columns: column one is the student
ID, and column two is the date on which the student was in class. Suppose there were
50 students, who on average attended exactly 10 classes each during the semester,
this means we have $10  50$ rows of data, with differing numbers of
rows for each student. This is the input matrix for this function here.
OUTPUT MATRIX: Now we want to generate a new dataframe, where each row is a date, and each column
is a student. The values in the new dataframe shows, at the $Q^th$ day, how many
classes student $i$ has attended so far. The following results is also in a REconTools
Function. This is shown as df outputed by this function generated below.
This function is useful beyond the roster example. It is used in the optimal allocation
problem as well. There are individual recipients of allocation, and each can receive some Q
units of allocations. Given total resources available, what is the sequence in which allocation
should be given to each. The input dataframe has two columns, the ID of each individual, and
the queue rank for a particular allocation for this individual. Expanding to wide gives us
a new df where each row is each additional unit of aggregate allocation available, and each
column is a different individual. The values says at the current level of overall resources
how many units of resources go to each of the individual." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-92953468-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-92953468-5');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">REconTools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/fv_dist_gini_vector_pos.html">DIST GINI--Compute Gini Inequality Coefficient Given Data Vector (One Variable)</a>
    </li>
    <li>
      <a href="../articles/fv_opti_bisect_pmap_multi.html">OPTI BISECT--Solve Roots for N (Rows) Strictly Monotonic Functions with Single Zero-Crossing</a>
    </li>
    <li>
      <a href="../articles/fv_panel_cumsum_grouplast.html">PANEL CUMSUM LAST--Cumulative Sum by Index Up to Last in Group</a>
    </li>
    <li>
      <a href="../articles/fv_panel_expand_longandwide.html">PANEL EXPAND--Append Group Mean Lagged Values as Additional Panel Variables</a>
    </li>
    <li>
      <a href="../articles/fv_summ_bygroup.html">SUMM BYGROUP--Summarize Variable by Factor Groups</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/FanWangEcon/REconTools/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>long Panel Record Date of Attendance each ID, Expand to Wide of Cumulative Attendance by Dates</h1>
    <small class="dont-index">Source: <a href='https://github.com/FanWangEcon/REconTools/blob/master/R/ff_panel_expand.R'><code>R/ff_panel_expand.R</code></a></small>
    <div class="hidden name"><code>ff_panel_expand_longrosterwide.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>INPUT MATRIX: There are $N$ students in class, but only a subset of them attend class each day.
If student $id_i$ is in class on day $Q$, the teacher records on a sheet the date
and the student ID. So if the student has been in class 10 times, the teacher has
ten rows of recorded data for the student with two columns: column one is the student
ID, and column two is the date on which the student was in class. Suppose there were
50 students, who on average attended exactly 10 classes each during the semester,
this means we have $10  50$ rows of data, with differing numbers of
rows for each student. This is the input matrix for this function here.</p>
<p>OUTPUT MATRIX: Now we want to generate a new dataframe, where each row is a date, and each column
is a student. The values in the new dataframe shows, at the $Q^th$ day, how many
classes student $i$ has attended so far. The following results is also in a REconTools
Function. This is shown as df outputed by this function generated below.</p>
<p>This function is useful beyond the roster example. It is used in the optimal allocation
problem as well. There are individual recipients of allocation, and each can receive some Q
units of allocations. Given total resources available, what is the sequence in which allocation
should be given to each. The input dataframe has two columns, the ID of each individual, and
the queue rank for a particular allocation for this individual. Expanding to wide gives us
a new df where each row is each additional unit of aggregate allocation available, and each
column is a different individual. The values says at the current level of overall resources
how many units of resources go to each of the individual.</p>
    </div>

    <pre class="usage"><span class='fu'>ff_panel_expand_longrosterwide</span>(<span class='no'>df</span>, <span class='no'>svr_id_t</span>, <span class='no'>svr_id_i</span>, <span class='kw'>st_idcol_prefix</span> <span class='kw'>=</span> <span class='st'>"id_"</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>svr_id_t</th>
      <td><p>string time variable name</p></td>
    </tr>
    <tr>
      <th>svr_id_i</th>
      <td><p>string individual ID name</p></td>
    </tr>
    <tr>
      <th>st_idcol_prefix</th>
      <td><p>string prefix for wide id</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a list of two dataframes</p><ul>
<li><p>df_roster_wide - a wide dataframe rows are unique dates, columns are individuals,
  cells are 1 if attended that day</p></li>
<li><p>df_roster_wide_cumu - a wide dataframe rows are unique dates, columns are individuals,
  cells show cumulative attendance</p></li>
</ul>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p><a href='https://fanwangecon.github.io/REconTools/reference/ff_panel_expand_longrosterwide.html'>https://fanwangecon.github.io/REconTools/reference/ff_panel_expand_longrosterwide.html</a>
<a href='https://fanwangecon.github.io/R4Econ/panel/widelong/fs_pivotwider.html'>https://fanwangecon.github.io/R4Econ/panel/widelong/fs_pivotwider.html</a>
<a href='https://github.com/FanWangEcon/REconTools/blob/master/R/ff_panel_expand.R'>https://github.com/FanWangEcon/REconTools/blob/master/R/ff_panel_expand.R</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>dplyr</span>)
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>tidyr</span>)
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>tibble</span>)
<span class='co'># Generate Input Data Structure</span>
<span class='co'># Define</span>
<span class='no'>it_N</span> <span class='kw'>&lt;-</span> <span class='fl'>3</span>
<span class='no'>it_M</span> <span class='kw'>&lt;-</span> <span class='fl'>5</span>
<span class='no'>svr_id</span> <span class='kw'>&lt;-</span> <span class='st'>'student_id'</span>

<span class='co'># from : support/rand/fs_rand_draws.Rmd</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>222</span>)
<span class='no'>df_panel_attend_date</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/reexports.html'>as_tibble</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='no'>it_M</span>, <span class='kw'>nrow</span><span class='kw'>=</span><span class='no'>it_N</span>, <span class='kw'>ncol</span><span class='kw'>=</span><span class='fl'>1</span>)) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://tibble.tidyverse.org/reference/rownames.html'>rowid_to_column</a></span>(<span class='kw'>var</span> <span class='kw'>=</span> <span class='no'>svr_id</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/uncount.html'>uncount</a></span>(<span class='no'>V1</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span>(!!<span class='fu'><a href='https://dplyr.tidyverse.org/reference/tidyeval.html'>sym</a></span>(<span class='no'>svr_id</span>)) <span class='kw'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span>(<span class='kw'>date</span> <span class='kw'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/ranking.html'>row_number</a></span>()) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span>() <span class='kw'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span>(<span class='kw'>in_class</span> <span class='kw'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fu'><a href='https://dplyr.tidyverse.org/reference/n.html'>n</a></span>(),<span class='kw'>mean</span><span class='kw'>=</span><span class='fl'>0</span>,<span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>1</span>) <span class='kw'>&lt;</span> <span class='fl'>0</span> ~ <span class='fl'>1</span>, <span class='fl'>TRUE</span> ~ <span class='fl'>0</span>)) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span>(<span class='no'>in_class</span> <span class='kw'>==</span> <span class='fl'>1</span>) <span class='kw'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span>(!!<span class='fu'><a href='https://dplyr.tidyverse.org/reference/tidyeval.html'>sym</a></span>(<span class='no'>svr_id</span>), <span class='no'>date</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>rename</a></span>(<span class='kw'>date_in_class</span> <span class='kw'>=</span> <span class='no'>date</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: The `x` argument of `as_tibble.matrix()` must have column names if `.name_repair` is omitted as of tibble 2.0.0.</span>
#&gt; <span class='warning'>Using compatibility `.name_repair`.</span>
#&gt; <span class='warning'><span style='color: #555555;'>This warning is displayed once every 8 hours.</span><span></span>
#&gt; <span class='warning'></span><span style='color: #555555;'>Call `lifecycle::last_warnings()` to see where this warning was generated.</span><span></span></div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='no'>df_panel_attend_date</span>)</div><div class='output co'>#&gt; </span><span style='color: #555555;'># A tibble: 8 x 2</span><span>
#&gt;   student_id date_in_class
#&gt;        </span><span style='color: #555555;font-style: italic;'>&lt;int&gt;</span><span>         </span><span style='color: #555555;font-style: italic;'>&lt;int&gt;</span><span>
#&gt; </span><span style='color: #555555;'>1</span><span>          1             2
#&gt; </span><span style='color: #555555;'>2</span><span>          1             4
#&gt; </span><span style='color: #555555;'>3</span><span>          2             1
#&gt; </span><span style='color: #555555;'>4</span><span>          2             2
#&gt; </span><span style='color: #555555;'>5</span><span>          2             5
#&gt; </span><span style='color: #555555;'>6</span><span>          3             2
#&gt; </span><span style='color: #555555;'>7</span><span>          3             3
#&gt; </span><span style='color: #555555;'>8</span><span>          3             5</div><div class='input'>
<span class='co'># Parameters</span>
<span class='no'>df</span> <span class='kw'>&lt;-</span> <span class='no'>df_panel_attend_date</span>
<span class='no'>svr_id_i</span> <span class='kw'>&lt;-</span> <span class='st'>'student_id'</span>
<span class='no'>svr_id_t</span> <span class='kw'>&lt;-</span> <span class='st'>'date_in_class'</span>
<span class='no'>st_idcol_prefix</span> <span class='kw'>&lt;-</span> <span class='st'>'sid_'</span>

<span class='co'># Invoke Function</span>
<span class='no'>ls_df_rosterwide</span> <span class='kw'>&lt;-</span> <span class='fu'>ff_panel_expand_longrosterwide</span>(<span class='no'>df</span>, <span class='no'>svr_id_t</span>, <span class='no'>svr_id_i</span>, <span class='no'>st_idcol_prefix</span>)
<span class='no'>df_roster_wide_func</span> <span class='kw'>&lt;-</span> <span class='no'>ls_df_rosterwide</span>$<span class='no'>df_roster_wide</span>
<span class='no'>df_roster_wide_cumu_func</span> <span class='kw'>&lt;-</span> <span class='no'>ls_df_rosterwide</span>$<span class='no'>df_roster_wide_cumu</span>

<span class='co'># Print</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='no'>df_roster_wide_func</span>)</div><div class='output co'>#&gt; </span><span style='color: #555555;'># A tibble: 5 x 4</span><span>
#&gt;   date_in_class sid_1 sid_2 sid_3
#&gt;           </span><span style='color: #555555;font-style: italic;'>&lt;int&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>
#&gt; </span><span style='color: #555555;'>1</span><span>             1    </span><span style='color: #BB0000;'>NA</span><span>     1    </span><span style='color: #BB0000;'>NA</span><span>
#&gt; </span><span style='color: #555555;'>2</span><span>             2     1     1     1
#&gt; </span><span style='color: #555555;'>3</span><span>             3    </span><span style='color: #BB0000;'>NA</span><span>    </span><span style='color: #BB0000;'>NA</span><span>     1
#&gt; </span><span style='color: #555555;'>4</span><span>             4     1    </span><span style='color: #BB0000;'>NA</span><span>    </span><span style='color: #BB0000;'>NA</span><span>
#&gt; </span><span style='color: #555555;'>5</span><span>             5    </span><span style='color: #BB0000;'>NA</span><span>     1     1</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='no'>df_roster_wide_cumu_func</span>)</div><div class='output co'>#&gt; </span><span style='color: #555555;'># A tibble: 5 x 4</span><span>
#&gt;   date_in_class sid_1 sid_2 sid_3
#&gt;           </span><span style='color: #555555;font-style: italic;'>&lt;int&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>
#&gt; </span><span style='color: #555555;'>1</span><span>             1     0     1     0
#&gt; </span><span style='color: #555555;'>2</span><span>             2     1     2     1
#&gt; </span><span style='color: #555555;'>3</span><span>             3     1     2     2
#&gt; </span><span style='color: #555555;'>4</span><span>             4     2     2     2
#&gt; </span><span style='color: #555555;'>5</span><span>             5     2     3     3</div></span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Fan Wang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


